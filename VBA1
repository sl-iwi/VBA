Sub Macro1()

Dim Sh1Coll As New Collection
Dim Sh2Coll As New Collection
Dim k1 As Integer, k2 As Integer
Dim ID As String
Dim SumArray(1 To 4) As Variant
Dim GetArray As Variant, g As Variant

Set sh1 = Sheets("Sheet1")
Set sh2 = Sheets("Sheet2")

k1 = 2
k2 = 2

sh1.UsedRange 'Refresh UsedRange
  LastRowsh1 = sh1.UsedRange.Rows(sh1.UsedRange.Rows.Count).Row
   sh2.UsedRange 'Refresh UsedRange
  LastRowsh2 = sh2.UsedRange.Rows(sh1.UsedRange.Rows.Count).Row

    Do While k2 <> LastRowsh2 'checking 2nd sheet until the end
         For j = 2 To 5 Step 1 ' checking columns
    
            If sh2.Cells(k2, j) <> "" Then   'checking SUM Cell
                SumArray(j - 1) = sh2.Cells(k2, j) ' Create array with SUM..
            End If
    
        Next j
        ID = sh2.Cells(k2, 1)
        k2 = k2 + 1
         
   
   Sh2Coll.Add SumArray, ID ' Pushing array to Collection
    
   Erase SumArray
Loop

' Filling the 1st Sheet
   
For k1 = 2 To LastRowsh1
        
    If Exists(Sh2Coll, sh1.Cells(k1, 2)) Then ' Checking ID
       
       GetArray = Sh2Coll.Item(CStr(sh1.Cells(k1, 2)))
       For g = LBound(GetArray) To UBound(GetArray)
            If IsEmpty(GetArray(g)) = False Then 'If there is no SUM in Array - skip, else
       
                If IsEmpty(sh1.Cells(k1, 3)) = True Then  ' Checking that Cell is empty
                    sh1.Cells(k1, 3) = g  ' Sheet1.Cat = Sheet2.CategoryRow
                    sh1.Cells(k1, 4) = GetArray(g)  'Entering sum
                Else  ' adding a row in case Cell already has SUM
                    k1 = k1 + 1
                 sh1.UsedRange 'Refresh UsedRange
                    LastRowsh1 = sh1.UsedRange.Rows(sh1.UsedRange.Rows.Count).Row + 1
                   Range(sh1.Rows(k1), sh1.Rows(k1)).Insert Shift:=x1Down
                    sh1.Cells(k1, 3) = g  ' Sheet1.Cat = Sheet2.CategoryRow
                    sh1.Cells(k1, 4) = GetArray(g) 'Entering sum
                    sh1.Cells(k1, 5) = "X" ' Entering Property
                    
                End If
            End If
      
       Next g

      End If
  
  sh1.UsedRange 'Refresh UsedRange
  LastRowsh1 = sh1.UsedRange.Rows(sh1.UsedRange.Rows.Count).Row
  
Next k1


End Sub

Function Exists(coll As Collection, key As String) As Boolean

    On Error GoTo EH

    coll.Item key
    
    Exists = True
EH:
End Function
